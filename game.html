<!doctype HTML><script>var __extends=this&&this.__extends||function(){var a=function(b,c){a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(b,c){b.__proto__=c}||function(b,c){for(var a in c)c.hasOwnProperty(a)&&(b[a]=c[a])};return a(b,c)};return function(b,c){function d(){this.constructor=b}a(b,c);b.prototype=null===c?Object.create(c):(d.prototype=c.prototype,new d)}}(),Main=function(){function a(){}a.main=function(){document.title="Board game";var b=new Board(20,20);new Ball;document.onkeydown=function(c){var a=
    Keyboard.getKeyCode(c);c=null;a==Keyboard.Key.UP?c=b.ball.position.movedUp():a==Keyboard.Key.DOWN?c=b.ball.position.movedDown():a==Keyboard.Key.LEFT?c=b.ball.position.movedLeft():a==Keyboard.Key.RIGHT&&(c=b.ball.position.movedRight());c&&b.canMoveTo(c)&&(b.ball.setPosition(c),b.updateBallPosition(),a=b.getObjectAtPosition(c),null!=a&&a.isCollectable()&&b.removeCoin(c))}};return a}();document.addEventListener("DOMContentLoaded",Main.main);
    var Board=function(){function a(b,c){this.width=b;this.height=c;this.container=new View;this.objects=[];var a=Math.min(window.innerHeight,window.innerWidth);this.container.setSize(a);this.gridSize=Math.floor(a/Math.max(b,c));for(a=0;a<this.width;a++){this.objects[a]=[];for(var e=0;e<this.height;e++)this.objects[a][e]=null}a=Maze.generate(this);for(e=0;e<this.width;e++)for(var f=0;f<this.height;f++)0==a[e][f]?this.addBlockAtPosition(new BoardPosition(e,f)):this.addTileAtPosition(e,f);for(this.coinsCount=
    0;50>this.coinsCount;)a=this.randomPosition(),null==this.getObjectAtPosition(a)&&(this.addCoinAtPosition(a),this.coinsCount++);a=b/2;e=c/2;this.ball=new Ball;this.ball.setPosition(new BoardPosition(a,e));this.ball.setSize(this.gridSize);this.ball.setLeft(this.toPosition(a));this.ball.setTop(this.toPosition(e));this.container.append(this.ball.element)}a.prototype.addTileAtPosition=function(b,a){var c=new Block;c.setBackgroundColor(0,Math.round(32*Math.random())+127,0);c.setSize(this.gridSize);c.setLeft(this.toPosition(b));
    c.setTop(this.toPosition(a));this.container.append(c.element)};a.prototype.addBlockAtPosition=function(b){var a=new Block,d=Math.round(16*Math.random())+15;a.setLeft(this.toPosition(b.x));a.setTop(this.toPosition(b.y));a.setBackgroundColor(0,0,d);a.setSize(this.gridSize);this.setObjectAtPosition(b,a);this.container.append(a.element)};a.prototype.addCoinAtPosition=function(b){var a=new Coin,d=Math.round(1*this.gridSize/6);a.setSize(Math.round(2*this.gridSize/3));a.setLeft(b.x*this.gridSize);a.setTop(b.y*
    this.gridSize);a.setMargin(d);this.setObjectAtPosition(b,a);this.container.append(a.element)};a.prototype.addBallElement=function(b,a){};a.prototype.updateBallPosition=function(){this.ball.setLeft(this.toPosition(this.ball.position.x));this.ball.setTop(this.toPosition(this.ball.position.y))};a.prototype.getObjectAtPosition=function(b){return this.objects[b.x][b.y]};a.prototype.toPosition=function(b){return this.gridSize*b};a.prototype.randomPosition=function(){var b=Random.fromInterval(0,this.width-
    1),a=Random.fromInterval(0,this.height-1);return new BoardPosition(b,a)};a.prototype.isBlockedPosition=function(b){return(b=this.getObjectAtPosition(b))?b.isBlocker():!1};a.prototype.hasPosition=function(b){return 0>b.x||0>b.y||b.x>=this.width||b.y>=this.height?!1:!0};a.prototype.canMoveTo=function(b){return this.hasPosition(b)&&!this.isBlockedPosition(b)};a.prototype.removeCoin=function(b){var a=this.getObjectAtPosition(b);a&&(this.container.remove(a.element),this.removeObjectAtPosition(b),this.coinsCount--,
    0==this.coinsCount&&alert("You win!"))};a.prototype.removeObjectAtPosition=function(b){this.objects[b.x][b.y]=null};a.prototype.setObjectAtPosition=function(b,a){this.objects[b.x][b.y]=a};return a}(),BoardItem=function(){function a(){this.element=new ViewElement;this.element.setPosition("absolute");this.position=new BoardPosition(0,0)}a.prototype.setSize=function(b){this.element.setSize(b)};a.prototype.setRoundShape=function(){this.element.setRoundShape()};a.prototype.setBackgroundColor=function(b,
    a,d){b=this.createCSSColor(b,a,d);this.element.setBackgroundColor(b)};a.prototype.setLayerIndex=function(b){this.element.setLayerIndex(b)};a.prototype.setBorderColor=function(b,a,d){b=this.createCSSColor(b,a,d);this.element.setBorderColor(b)};a.prototype.setSolidBorder=function(){this.element.setSolidBorder()};a.prototype.setBorderWidth=function(b){this.element.setBorderWidth(b)};a.prototype.setLeft=function(b){this.element.setLeft(b)};a.prototype.setTop=function(b){this.element.setTop(b)};a.prototype.setMargin=
    function(b){this.element.setMargin(b)};a.prototype.isBlocker=function(){return!1};a.prototype.isCollectable=function(){return!1};a.prototype.createCSSColor=function(b,a,d){return"rgb("+b+","+a+","+d+")"};return a}(),BoardPosition=function(){function a(b,a){this.x=b;this.y=a}a.prototype.movedLeft=function(){return new a(this.x-1,this.y)};a.prototype.movedRight=function(){return new a(this.x+1,this.y)};a.prototype.movedUp=function(){return new a(this.x,this.y-1)};a.prototype.movedDown=function(){return new a(this.x,
    this.y+1)};return a}(),Keyboard;(function(a){a.Key={UP:38,DOWN:40,LEFT:37,RIGHT:39};a.getKeyCode=function(a){return a.keyCode}})(Keyboard||(Keyboard={}));
    var Ball=function(a){function b(){var b=a.call(this)||this;b.setRoundShape();b.setBackgroundColor(127,0,0);b.setLayerIndex(3);return b}__extends(b,a);b.prototype.setPosition=function(b){this.position=b};return b}(BoardItem),Block=function(a){function b(){var b=a.call(this)||this;b.setLayerIndex(1);return b}__extends(b,a);b.prototype.isBlocker=function(){return!0};return b}(BoardItem),Coin=function(a){function b(){var b=a.call(this)||this;b.setLayerIndex(2);b.setBackgroundColor(220,200,0);b.setRoundShape();
    b.setBorderColor(120,120,0);b.setSolidBorder();b.setBorderWidth(2);return b}__extends(b,a);b.prototype.isCollectable=function(){return!0};return b}(BoardItem),Maze;
    (function(a){a.generate=function(b){for(var a=[],d=0;d<b.width;d++){a[d]=[];for(var e=0;e<b.height;e++)a[d][e]=0}a[b.width/2][b.height/2]=1;d=b.width*b.height*.8;for(e=0;e<d;){var f=b.randomPosition(),h=0;if(0<f.x){var g=f.movedLeft();1==a[g.x][g.y]&&h++}0<f.y&&(g=f.movedUp(),1==a[g.x][g.y]&&h++);f.x<b.width-1&&(g=f.movedRight(),1==a[g.x][g.y]&&h++);f.y<b.height-1&&(g=f.movedDown(),1==a[g.x][g.y]&&h++);1==h&&(a[f.x][f.y]=1,e++)}return a}})(Maze||(Maze={}));var Random;
    (function(a){a.fromInterval=function(b,a){return Math.floor(Math.random()*(a-b+1))+b}})(Random||(Random={}));
    var View=function(){function a(){this.wrapper=new ViewElement;this.wrapper.setMargin("auto");this.wrapper.setPosition("relative");document.body.appendChild(this.wrapper.element);document.body.style.margin="0";document.body.style.backgroundColor="black"}a.prototype.setSize=function(b){this.wrapper.setSize(b)};a.prototype.append=function(b){this.wrapper.element.appendChild(b.element)};a.prototype.remove=function(b){this.wrapper.element.removeChild(b.element)};return a}(),ViewElement=function(){function a(){this.element=
    document.createElement("div");this.element.style.boxSizing="border-box"}a.prototype.setMargin=function(b){this.element.style.margin="string"===typeof b?b:b+"px"};a.prototype.setBackgroundColor=function(b){this.element.style.backgroundColor=b};a.prototype.setPosition=function(b){this.element.style.position=b};a.prototype.setSize=function(b,a){void 0===a&&(a=b);this.element.style.width=b+"px";this.element.style.height=a+"px"};a.prototype.setRoundShape=function(){this.element.style.borderRadius="50%"};
    a.prototype.setLayerIndex=function(a){this.element.style.zIndex=a.toString()};a.prototype.setBorderColor=function(a){this.element.style.borderColor=a};a.prototype.setSolidBorder=function(){this.element.style.borderStyle="solid"};a.prototype.setBorderWidth=function(a){this.element.style.borderWidth=a+"px"};a.prototype.setLeft=function(a){this.element.style.left=a+"px"};a.prototype.setTop=function(a){this.element.style.top=a+"px"};return a}();</script>
